# ç§’æ€ç³»ç»Ÿé¡¹ç›®ç´¢å¼•

> **é¡¹ç›®éš¾åº¦**: â­â­â­ (3/5)
> **æ ¸å¿ƒæŠ€èƒ½**: å¹¶å‘ç¼–ç¨‹ã€é”ä¼˜åŒ–ã€æ€§èƒ½è°ƒä¼˜
> **é¢„è®¡å­¦æ—¶**: 3-8 å°æ—¶

## ğŸ“– æ–‡æ¡£å¯¼èˆª

### å¿«é€Ÿå…¥é—¨
- **[QUICK_START.md](QUICK_START.md)** - 5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ âš¡
  - æœ€å¿«ä¸Šæ‰‹æ–¹å¼
  - æ ¸å¿ƒä»£ç å¯¹æ¯”
  - å¸¸è§é—®é¢˜ FAQ

### è¯¦ç»†å­¦ä¹ 
- **[README.md](README.md)** - å®Œæ•´é¡¹ç›®æ–‡æ¡£ ğŸ“š
  - é¡¹ç›®èƒŒæ™¯å’Œç›®æ ‡
  - å­¦ä¹ è·¯å¾„æŒ‡å—
  - å¸¸è§é™·é˜±è§£æ
  - æ‰©å±•æ€è€ƒ

### æ€§èƒ½åˆ†æ
- **[PERFORMANCE_COMPARISON.md](PERFORMANCE_COMPARISON.md)** - æ€§èƒ½å¯¹æ¯”æŠ¥å‘Š ğŸ“Š
  - ä¸‰ä¸ªç‰ˆæœ¬å®æµ‹æ•°æ®
  - æ€§èƒ½æå‡åˆ†æ
  - JMH åŸºå‡†æµ‹è¯•

### æ¶æ„è®¾è®¡
- **[ARCHITECTURE.md](ARCHITECTURE.md)** - ç³»ç»Ÿæ¶æ„è®¾è®¡ ğŸ—ï¸
  - ç‰ˆæœ¬æ¼”è¿›æ¶æ„
  - å¹¶å‘æµç¨‹å›¾
  - å†…å­˜æ¨¡å‹åˆ†æ
  - åˆ†å¸ƒå¼æ‰©å±•

### é¡¹ç›®æ€»ç»“
- **[PROJECT_SUMMARY.md](PROJECT_SUMMARY.md)** - é¡¹ç›®å®Œæˆæ€»ç»“ âœ…
  - æ–‡ä»¶æ¸…å•
  - æµ‹è¯•ç»“æœ
  - å…³é”®æˆæœ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šè§‚å¯Ÿå¹¶å‘ Bug
```bash
cd starter-code
mvn clean compile exec:java
```
**é¢„æœŸç»“æœ**: å‘ç”Ÿè¶…å–ï¼Œè¶…å–æ•°é‡çº¦ 40 ä»¶

### ç¬¬äºŒæ­¥ï¼šè¿è¡Œæ­£ç¡®è§£å†³æ–¹æ¡ˆ
```bash
# V1 - Synchronized (æœ€ç®€å•)
cd solution/v1-synchronized
mvn exec:java

# V2 - ReentrantLock (æ›´å¿«)
cd solution/v2-reentrantlock
mvn exec:java

# V3 - Optimized (æœ€å¿«)
cd solution/v3-optimized
mvn exec:java
```

### ç¬¬ä¸‰æ­¥ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•
```bash
cd benchmark
mvn clean package
java -jar target/benchmarks.jar
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
project-01-flash-sale/
â”‚
â”œâ”€â”€ ğŸ“„ æ–‡æ¡£ (6ä¸ª)
â”‚   â”œâ”€â”€ INDEX.md                      # æœ¬æ–‡ä»¶ - é¡¹ç›®ç´¢å¼•
â”‚   â”œâ”€â”€ README.md                     # è¯¦ç»†é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ QUICK_START.md                # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”‚   â”œâ”€â”€ PERFORMANCE_COMPARISON.md     # æ€§èƒ½å¯¹æ¯”æŠ¥å‘Š
â”‚   â”œâ”€â”€ ARCHITECTURE.md               # æ¶æ„è®¾è®¡æ–‡æ¡£
â”‚   â””â”€â”€ PROJECT_SUMMARY.md            # é¡¹ç›®æ€»ç»“
â”‚
â”œâ”€â”€ ğŸ“¦ èµ·å§‹ä»£ç 
â”‚   â””â”€â”€ starter-code/                 # åŒ…å« bug çš„ç¤ºä¾‹ä»£ç 
â”‚       â”œâ”€â”€ FlashSaleService.java     # å¾…å®ç°æ¥å£
â”‚       â””â”€â”€ Main.java                 # æµ‹è¯•å…¥å£ï¼ˆæœ‰ bugï¼‰
â”‚
â”œâ”€â”€ ğŸ”§ è§£å†³æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ v1-synchronized/              # ç‰ˆæœ¬1: synchronized
â”‚   â”œâ”€â”€ v2-reentrantlock/             # ç‰ˆæœ¬2: ReentrantLock
â”‚   â””â”€â”€ v3-optimized/                 # ç‰ˆæœ¬3: AtomicInteger + CAS
â”‚
â””â”€â”€ ğŸ“Š æ€§èƒ½æµ‹è¯•
    â””â”€â”€ benchmark/                     # JMH åŸºå‡†æµ‹è¯•
```

## ğŸ¯ å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬é¡¹ç›®ï¼Œä½ å°†æŒæ¡ï¼š

### å¹¶å‘é—®é¢˜è¯Šæ–­
- âœ… ç†è§£ç«æ€æ¡ä»¶ (Race Condition)
- âœ… è¯†åˆ« check-then-act æ¨¡å¼çš„å±é™©
- âœ… ä½¿ç”¨å¤šçº¿ç¨‹æµ‹è¯•æš´éœ² bug

### åŒæ­¥æœºåˆ¶å¯¹æ¯”
- âœ… synchronized çš„ä½¿ç”¨å’Œå±€é™
- âœ… ReentrantLock çš„é«˜çº§ç‰¹æ€§
- âœ… é”ç²’åº¦å¯¹æ€§èƒ½çš„å½±å“

### æ€§èƒ½ä¼˜åŒ–æŠ€å·§
- âœ… ç»†ç²’åº¦é” vs å…¨å±€é”
- âœ… æ— é”æ•°æ®ç»“æ„ (AtomicInteger)
- âœ… CAS åŸå­æ“ä½œåŸç†
- âœ… å¿«é€Ÿå¤±è´¥ç­–ç•¥

### åŸºå‡†æµ‹è¯•
- âœ… JMH å¾®åŸºå‡†æµ‹è¯•
- âœ… ååé‡ vs å»¶è¿Ÿåˆ†æ
- âœ… å¹¶å‘åº¦å½±å“è¯„ä¼°

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”é€Ÿè§ˆ

| ç‰ˆæœ¬ | å®ç°æ–¹å¼ | ååé‡ | è€—æ—¶ | æå‡ | æ­£ç¡®æ€§ |
|------|---------|--------|------|------|--------|
| Starter | æ— é” | ~1200 TPS | 110ms | - | âœ— è¶…å– 42 |
| V1 | synchronized | 757 TPS | 132ms | åŸºå‡† | âœ“ æ­£ç¡® |
| V2 | ReentrantLock | 800 TPS | 125ms | +6% | âœ“ æ­£ç¡® |
| V3 | AtomicInteger | 934 TPS | 107ms | +23% | âœ“ æ­£ç¡® |

## ğŸ’¡ æ ¸å¿ƒçŸ¥è¯†ç‚¹

### 1. ç«æ€æ¡ä»¶ç¤ºä¾‹
```java
// âŒ é”™è¯¯ï¼šéåŸå­æ“ä½œ
if (stock > 0) {    // Thread-1, Thread-2 åŒæ—¶é€šè¿‡
    stock--;        // éƒ½æ‰§è¡Œæ‰£å‡ â†’ è¶…å–ï¼
}

// âœ… æ­£ç¡®ï¼šåŸå­æ“ä½œ
synchronized (lock) {
    if (stock > 0) stock--;
}
```

### 2. ä¸‰ç§åŒæ­¥æœºåˆ¶

**synchronized (V1)**
```java
public synchronized String buy(...) {
    // å…¨å±€é”ï¼Œç®€å•å¯é ï¼Œæ€§èƒ½è¾ƒä½
}
```

**ReentrantLock (V2)**
```java
ReentrantLock lock = lockMap.get(productId);
if (lock.tryLock(100, TimeUnit.MILLISECONDS)) {
    try {
        // ç»†ç²’åº¦é”ï¼Œæ”¯æŒè¶…æ—¶
    } finally {
        lock.unlock();
    }
}
```

**AtomicInteger (V3)**
```java
while (true) {
    int current = stock.get();
    if (current <= 0) return null;
    if (stock.compareAndSet(current, current-1)) {
        break;  // CAS æˆåŠŸï¼Œæ— é”é«˜æ€§èƒ½
    }
}
```

### 3. æ€§èƒ½ä¼˜åŒ–è·¯å¾„

```
V1: å…¨å±€é”
    1000 çº¿ç¨‹ â†’ 1 æŠŠé” â†’ é«˜ç«äº‰
    â†“
V2: ç»†ç²’åº¦é”
    1000 çº¿ç¨‹ â†’ N ä¸ªå•†å“ â†’ æ¯ä¸ªå•†å“ 1 æŠŠé” â†’ ä¸­ç«äº‰
    â†“
V3: æ— é” + CAS
    90% æ— é”å¿«é€Ÿå¤±è´¥ + 10% CAS æ‰£å‡ â†’ ä½ç«äº‰
```

## ğŸ“š æ¨èå­¦ä¹ é¡ºåº

### é˜¶æ®µ 1: ç†è§£é—®é¢˜ (30åˆ†é’Ÿ)
1. é˜…è¯» [QUICK_START.md](QUICK_START.md)
2. è¿è¡Œ starter-codeï¼Œè§‚å¯Ÿè¶…å–
3. ç†è§£ç«æ€æ¡ä»¶åŸå› 

### é˜¶æ®µ 2: åŸºç¡€å®ç° (1å°æ—¶)
1. å­¦ä¹  V1 - synchronized å®ç°
2. è‡ªå·±å°è¯•å®ç° FlashSaleService
3. è¿è¡Œæµ‹è¯•éªŒè¯æ­£ç¡®æ€§

### é˜¶æ®µ 3: æ€§èƒ½ä¼˜åŒ– (2å°æ—¶)
1. å­¦ä¹  V2 - ReentrantLock ä¼˜åŒ–
2. å­¦ä¹  V3 - AtomicInteger ä¼˜åŒ–
3. å¯¹æ¯”ä¸‰ä¸ªç‰ˆæœ¬çš„æ€§èƒ½å·®å¼‚

### é˜¶æ®µ 4: æ·±å…¥ç ”ç©¶ (2-4å°æ—¶)
1. é˜…è¯» [ARCHITECTURE.md](ARCHITECTURE.md)
2. è¿è¡Œ JMH åŸºå‡†æµ‹è¯•
3. æ€è€ƒåˆ†å¸ƒå¼åœºæ™¯æ‰©å±•

## ğŸ”— ç›¸å…³èµ„æº

### ä¹¦ç±
- ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ç¬¬ 2ã€3ã€13 ç« 
- ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹é”ä¼˜åŒ–ç« èŠ‚

### æ–‡æ¡£
- [ReentrantLock JavaDoc](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/ReentrantLock.html)
- [AtomicInteger JavaDoc](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicInteger.html)
- [JMH å®˜æ–¹æ–‡æ¡£](https://openjdk.org/projects/code-tools/jmh/)

### å®æˆ˜æ¡ˆä¾‹
- [ç¾å›¢æŠ€æœ¯åšå®¢ - é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿè®¾è®¡](https://tech.meituan.com/2017/03/16/flash-sale.html)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Java**: 8+
- **å¹¶å‘æ¡†æ¶**: java.util.concurrent
- **æ„å»ºå·¥å…·**: Maven
- **æµ‹è¯•æ¡†æ¶**: JUnit
- **æ€§èƒ½æµ‹è¯•**: JMH (Java Microbenchmark Harness)

## âœ¨ æ‰©å±•æ–¹å‘

å®ŒæˆåŸºç¡€é¡¹ç›®åï¼Œå¯ä»¥å°è¯•ï¼š

### 1. åˆ†å¸ƒå¼ç§’æ€
- [ ] Redis åˆ†å¸ƒå¼é” (Redisson)
- [ ] æ•°æ®åº“ä¹è§‚é”ï¼ˆç‰ˆæœ¬å·ï¼‰
- [ ] åˆ†å¸ƒå¼äº‹åŠ¡ (Seata)

### 2. é«˜çº§ä¼˜åŒ–
- [ ] åˆ†æ®µåº“å­˜ï¼ˆå‡å°‘ç«äº‰ï¼‰
- [ ] æ¶ˆæ¯é˜Ÿåˆ—å‰Šå³°ï¼ˆKafka/RabbitMQï¼‰
- [ ] å¤šçº§ç¼“å­˜ï¼ˆæœ¬åœ° + Redisï¼‰
- [ ] é™æµé™çº§ï¼ˆSentinel/Hystrixï¼‰

### 3. å·¥ç¨‹å®è·µ
- [ ] Spring Boot é›†æˆ
- [ ] æ•°æ®åº“æŒä¹…åŒ–ï¼ˆMySQL/PostgreSQLï¼‰
- [ ] ç›‘æ§å‘Šè­¦ï¼ˆPrometheus + Grafanaï¼‰
- [ ] å‹åŠ›æµ‹è¯•ï¼ˆJMeter/Gatlingï¼‰

## ğŸ“ å­¦ä¹ å»ºè®®

### é€‚åˆäººç¾¤
- Java å¼€å‘è€…ï¼ˆäº†è§£åŸºç¡€è¯­æ³•ï¼‰
- å­¦ä¹ å¹¶å‘ç¼–ç¨‹çš„åŒå­¦
- å‡†å¤‡é¢è¯•é«˜å¹¶å‘åœºæ™¯
- å®ç°ç”Ÿäº§çº§ç§’æ€ç³»ç»Ÿ

### å‰ç½®çŸ¥è¯†
- Java åŸºç¡€ï¼ˆå¤šçº¿ç¨‹ã€é›†åˆæ¡†æ¶ï¼‰
- äº†è§£ Maven åŸºæœ¬ä½¿ç”¨
- ç†è§£çº¿ç¨‹å®‰å…¨æ¦‚å¿µ

### å­¦ä¹ æŠ€å·§
1. **å…ˆè¿è¡Œï¼Œåç†è§£** - çœ‹åˆ°æ•ˆæœå†æ·±å…¥åŸç†
2. **å¯¹æ¯”å­¦ä¹ ** - ä¸‰ä¸ªç‰ˆæœ¬å¯¹æ¯”çœ‹å·®å¼‚
3. **åŠ¨æ‰‹å®è·µ** - è‡ªå·±å®ç°ä¸€éæ‰èƒ½çœŸæ­£æŒæ¡
4. **æ€§èƒ½æµ‹è¯•** - ç”¨æ•°æ®è¯´è¯ï¼ŒéªŒè¯ä¼˜åŒ–æ•ˆæœ

## ğŸ“ é—®é¢˜åé¦ˆ

é‡åˆ°é—®é¢˜æ—¶ï¼š
1. æŸ¥çœ‹ [README.md](README.md) çš„å¸¸è§é™·é˜±ç« èŠ‚
2. æ£€æŸ¥ä»£ç æ˜¯å¦æ­£ç¡®ç¼–è¯‘è¿è¡Œ
3. å¯¹æ¯”è§£å†³æ–¹æ¡ˆä¸­çš„å®ç°
4. é˜…è¯»è¯¦ç»†çš„ä»£ç æ³¨é‡Š

## ğŸ† å­¦ä¹ æˆæœæ£€éªŒ

å®Œæˆé¡¹ç›®åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š
- [ ] è§£é‡Šç«æ€æ¡ä»¶çš„æˆå› 
- [ ] è¯´å‡º synchronizedã€ReentrantLockã€AtomicInteger çš„åŒºåˆ«
- [ ] åˆ†æä¸åŒé”ç²’åº¦å¯¹æ€§èƒ½çš„å½±å“
- [ ] ä½¿ç”¨ JMH è¿›è¡Œæ€§èƒ½æµ‹è¯•
- [ ] è®¾è®¡ä¸€ä¸ªé˜²è¶…å–çš„ç§’æ€ç³»ç»Ÿ
- [ ] æ€è€ƒåˆ†å¸ƒå¼åœºæ™¯çš„è§£å†³æ–¹æ¡ˆ

---

**å¼€å§‹å­¦ä¹ **: å»ºè®®ä» [QUICK_START.md](QUICK_START.md) å¼€å§‹
**æ·±å…¥ç ”ç©¶**: é˜…è¯» [README.md](README.md) å’Œ [ARCHITECTURE.md](ARCHITECTURE.md)
**æ€§èƒ½åˆ†æ**: æŸ¥çœ‹ [PERFORMANCE_COMPARISON.md](PERFORMANCE_COMPARISON.md)

ç¥å­¦ä¹ æ„‰å¿«ï¼ğŸš€
